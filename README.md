# Renpho Scales - Health dashboard

* [ Overview ](#overview)
* [ Obtaining the data ](#obtaining_the_data)
* [ Running the Dashboard ](#running_the_dashboard)
	* [ Using Docker ](#using_docker)
	* [ Using RStudio ](#using_rstudio)
		* [ Install Packages ](#install_packages)
		* [ Running the Dashboard ](#running_the_dashboard_rstudio)
* [ Running Tests ](#running_tests)

<a name="overview"></a>
## Overview

This repository allows users of
[Renpho Bluetooth Scales](https://www.amazon.co.uk/RENPHO-Bluetooth-Bathroom-Skeletal-Metabolic/dp/B077RXM292)
to visualise the data generated by those scales. This is done with an R Shiny
flexdashboard.

<a name="obtaining_the_data"></a>
## Obtaining the Data

If you do not have any data then it is possible to use this dashboard with the existing
example data file.

Renpho scales synchronise data with a user's smartphone. To get the data from the Renpho
app, follow the following steps:

- Select the "Trends" tab
- Select the clock icon in the top right
- Select "Select data" in the top right
- Select the "..." in the top right
- Select "Select all data"
- Select the export data icon in the bottom left
- Export the .csv file somewhere you can access it

We will use this .csv file in the steps below

<a name="running_the_dashboard"></a>
## Running the Dashboard

The dashboard is designed to run hassle-free with Docker. If you do not wish to use docker
there are steps below to run the dashboard directly in RStudio.

For either process you should place your Renpho scales .csv data in the following folder:
`health/data`

There is already an example.csv in this folder and it should be removed when a new file
is placed in there.

<a name="using_docker"></a>
### Using Docker

If you have Docker already running, simply run the following command in the root directory
of this repository:
`docker-compose up -d`

This will download the necssary Docker image and install packages (this may take a
while if it is the first time). Once the process is complete the dashboard will be
available at the following link:

[Dashboard link](http://localhost:5001/health)

The dashboard will continue to run as long as Docker runs. To stop the server simply
run the following command in the root of this directory:
`docker-compose down`

<a name="using_rstudio"></a>
### Using RStudio

<a name="install_packages"></a>
#### Install Packages

Firstly you will need to ensure that the correct packages are installed on your machine.
This can be done with the file `health/install_packages.R`. You can either:

1) Run this script directly in RStudio
2) Run it from the command line using `Rscript health/install_packages.R`

<a name="running_the_dashboard_rstudio"></a>
#### Running the Dashboard

Once that is complete, open the file `health/health.Rmd` in RStudio.
Then simply press "Run Document" to run the dashboard.

<a name="running_tests"></a>
## Running Tests

There are two ways to run the tests:

1) If you are using the steps above to run via Docker, the tests are run automatically
when `docker-compose up -d` is run. The output of the tests will be shown as the last step
in the command line.
2) If you wish to run the tests manually, you must:
	- Ensure you have installed the necessary R packages in accordance with the section
	[ Install Packages ](#install_packages)
	- From the command line, when you are in the root directory of this repository,
	run the command: `R -e "testthat::test_dir('health/tests')"`